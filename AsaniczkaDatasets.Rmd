---
title: "Data Cleanup Project3"
author: "Miraj Patel"
date: "2025-03-22"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load library}
library(tidyr)
library(dplyr)
library(ggplot2)
library(stringr)
```

## Data cleanup

Dataset 1

```{r}
#Import the files
data1 <- read.csv("https://raw.githubusercontent.com/jerryjerald27/DATA607_Project3/refs/heads/main/job_postings.csv")
data1_1 <- read.csv("https://raw.githubusercontent.com/jerryjerald27/DATA607_Project3/refs/heads/main/job_skills.csv")

#combine the two files
df1 <- cbind(data1, data1_1)

#Desired columns
df2 <- df1[, c("job_skills", "job_level")]

# Count unique job levels and their frequencies
df2_job_level_counts <- df2 %>%
  group_by(job_level) %>%
  summarise(count = n()) %>%
  arrange(desc(count))

print(df2_job_level_counts)

# Separate multiple skills into individual rows
df2_job_skills_counts <- df2 %>%
  separate_rows(job_skills, sep = ",") %>% 
  mutate(job_skills = str_remove_all(job_skills, "\\*") %>% trimws()) %>%  # Remove "*"
  filter(!str_detect(job_skills, "\\b\\d{2,4}\\b|\\byears?\\b")) %>%  # Remove skills with years
  filter(job_skills != "") %>% 
  group_by(job_skills) %>%
  summarise(count = n()) %>%
  arrange(desc(count))

head(df2_job_skills_counts)
```

Dataset 2
```{r}
#Import file
data2 <- read.csv("https://raw.githubusercontent.com/jerryjerald27/DATA607_Project3/refs/heads/main/postings.csv")

#Desired columns
df3 <- data2[, c("job_skills","job.level")]

# Count unique job levels and their frequencies
df3_job.level_counts <- df3 %>%
  group_by(job.level) %>%
  summarise(count = n()) %>%
  arrange(desc(count))

print(df3_job.level_counts)

# Separate multiple skills into individual rows
df3_job_skills_counts <- df3 %>%
  separate_rows(job_skills, sep = ",") %>% 
  mutate(job_skills = str_remove_all(job_skills, "\\*") %>% trimws()) %>%  # Remove "*"
  filter(!str_detect(job_skills, "\\b\\d{2,4}\\b|\\byears?\\b")) %>%  # Remove skills with years
  filter(job_skills != "") %>% 
  group_by(job_skills) %>%
  summarise(count = n()) %>%
  arrange(desc(count))

head(df3_job_skills_counts)

```

Combine the counts for the job skills

```{r}
# Merge the two dataframes on job_skills
combined_job_skills_counts <- full_join(df2_job_skills_counts, df3_job_skills_counts, 
                                        by = "job_skills", suffix = c("_df2", "_df3"))

# Replace NA values with 0 and sum the counts
combined_job_skills_counts <- combined_job_skills_counts %>%
  mutate(count_df2 = ifelse(is.na(count_df2), 0, count_df2),
         count_df3 = ifelse(is.na(count_df3), 0, count_df3),
         total_count = count_df2 + count_df3) %>%
  select(job_skills, total_count) %>%
  arrange(desc(total_count))

# Display the top job skills
head(combined_job_skills_counts)

```

